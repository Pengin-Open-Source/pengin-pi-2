{% extends "layout/fullPageScroll.html" %}
{% load static %}  {# Load static files #}
{% load macros %}
{% loadmacros "macros/pagination.html" %}

{% block pageDropDowns %}
  <a href="{% url 'display_company_info' pk=company.id %}">Company Home</a>
{% endblock %}

{% block pageContent %}
  <div class="content-section">
    <h1 class="profile-title">Edit Company Members</h1>
    <form class="form" id="memberForm" method="POST" action="{% url 'edit_company_members' pk=company.id %}">
      {% csrf_token %}
      <input type="hidden" name="page-number" value="{{ page_obj.number }}"/>
      <div class="member-grid">
        {% for user in users %}
          <div>
            <input type="checkbox" id="{{ user.id }}" name="member-checkbox" value="{{ user.id }}"
                   {% if user.id in member_uid_list %} checked {% endif %} />
            <label for="{{ user.id }}">{{ user.name }}</label>
          </div>
        {% endfor %}
      </div>
      <button class="primary-button" type="submit">Save</button>
    </form>
    {% use_macro render_pagination page_obj %}
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
   <script type="text/javascript">

    const checkedValues = [];
    const uncheckedValues = [];
    const formData = new FormData(document.getElementById('memberForm'));

    const checkboxes = document.querySelectorAll('input[name="member-checkbox"]');


  
    checkboxes.forEach(checkbox => {
      checkbox.addEventListener('change', () => {
        if (checkbox.checked) {
          checkedValues.push(checkbox.value);
          uncheckedValues.splice(uncheckedValues.indexOf(checkbox.value), 1);
        } else {
          checkedValues.splice(checkedValues.indexOf(checkbox.value), 1);
          uncheckedValues.push(checkbox.value);
        }
      });
    });

    function myJavaScriptFunction() {
      const selectedUsers = JSON.stringify(checkedValues);
      const deselectedUsers = JSON.stringify(uncheckedValues);
      confirm(selectedUsers)
      confirm(deselectedUsers)
      fetch('{% url 'edit_company_members' pk=company.id %}?selected_users=' + encodeURIComponent(selectedUsers) + '&unselected_users=' + encodeURIComponent(deselectedUsers), {
        method: 'GET'});
    }

   </script>


{% endblock %}



