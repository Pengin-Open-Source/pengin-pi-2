{% load macros %}
{% loadmacros "macros/pagination.html" %}
{% macro render_comments comments current_user is_edited %}
  {% for comment in comments %}
  <tr><td>
    <div class="comment-title-underline">
    <div> <b> by {{comment.author.name|escape}} on {{comment.date|escape}} </b> </div>
    {% if comment.row_action == 'CREATE' %} 
       </div>
    {% elif comment.row_action == 'EDIT' %}
     <i> (Edited) </i> 
            </div>
            <div class="comment-title-underline">
              {% if comment.is_create_missing %}
              <p style="color: red;" >  
                <i> Comment Creation Date / Original Author not found!</i>
              </p>
              {% else %}
                  <p style="color: orange;" > 
                       <i> Originally posted by {{comment.author.name |escape}} on {{comment.create_date|escape}} </i>
                  </p>
              {% endif %}
           </div>
    {% else %}
       </div>
       <div class="comment-title-underline">
              <p style="color: red;" >  
                <i> Warning: This may be a restored comment's date of deletion. Notify your system administrator</i>
              </p>
        </div>
    {% endif %} 

    <div class="comment-title-underline">
        <p> {{comment.content}} </p>
    </div>
        {% if current_user.is_authenticated %}
          <div class="text-buttons-container">
            {% if user == comment.author or is_admin %}
              <form class="delete-form" method="post" action="{% url 'delete_comment' comment.id  %}">
                {% csrf_token %}
                <button class="text-button" style="color: purple;" type="submit" onclick="return confirm('Are you sure you want to delete this comment?')">Delete Comment</button>
              </form> 
              <span class="text-button">|</span>
            {% endif %}
            {% if user == comment.author or is_admin  %}
              <a class="text-button" style="color: purple;" href="{% url 'edit_comment' comment.post.thread.id comment.post.id comment.id %}">Edit Comment</a>
            {% endif %}
          </div>
        {% endif %}
   
  </td></tr>
  {% endfor %}
  {% use_macro render_pagination comments %}
{% endmacro %}